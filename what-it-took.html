<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>What It Took</title>

<link rel="stylesheet" href="styles.css">
<script defer src="script.js"></script>
</head>

<body onload="initStats()">

<div class="header-container">
  <div class="title-bubble">What It Took</div>
</div>

<<div class="bubble-container">

  <div class="stat-bubble">
    <div>Total Lines of Code:</div>
    <button onclick="revealLines(this)">Reveal</button>
    <div id="lineCount" class="red-stat"></div>
  </div>

  <div class="stat-bubble">
    <div>Coding Languages Used:</div>
    <button onclick="revealLanguages(this)">Reveal</button>
    <div id="languages" class="red-stat"></div>
  </div>

  <div class="stat-bubble">
    <div>A little help from:</div>
    <button onclick="revealChatGPT(this)">Reveal</button>
    <div id="chatgpt" class="red-stat"></div>
  </div>

</div>

  <div class="stat-bubble">
    <div>Total Project Size</div>
    <div id="fileSize">0 KB</div>
  </div>
</div>

<a href="index.html" class="what-it-took-banner">← Back</a>

<script>
let totalLines = 0;

async function initStats() {

  if (typeof createFloatingBubbles === "function") {
    createFloatingBubbles();
  }

  const files = [
    "index.html",
    "what-it-took.html",
    "styles.css",
    "script.js"
  ];

  for (const file of files) {
    try {
      const response = await fetch(file);
      if (!response.ok) continue;

      const text = await response.text();
      totalLines += text.split("\n").length;

    } catch (error) {
      console.warn("Error loading:", file);
    }
  }
}

/* -------- Reveal Functions -------- */

function revealLines() {
  animateSlowCount(
    document.getElementById("lineCount"),
    totalLines,
    2000
  );
}

function revealLanguages() {
  const el = document.getElementById("languages");
  el.textContent = "HTML";

  setTimeout(() => {
    el.textContent += ", CSS";
  }, 600);

  setTimeout(() => {
    el.textContent += ", JS";
  }, 1200);
}

function revealChatGPT() {
  document.getElementById("chatgpt").textContent =
  'ChatGPT (it\'s not cheating — it is called "Vibe Coding", and it\'s a skill!)';
}

/* -------- Fast → Slow Count Animation -------- */

function animateSlowCount(element, target, duration) {

  let start = 0;
  const startTime = performance.now();

  function update(currentTime) {

    const progress = Math.min((currentTime - startTime) / duration, 1);

    // easeOut effect (fast then slow)
    const eased = 1 - Math.pow(1 - progress, 3);

    const value = Math.floor(eased * target);

    element.textContent = value;

    if (progress < 1) {
      requestAnimationFrame(update);
    }
  }

  requestAnimationFrame(update);
}

  const files = [
    "index.html",
    "what-it-took.html",
    "styles.css",
    "script.js"
  ];

  let totalLines = 0;
  let totalBytes = 0;

  for (const file of files) {
    try {
      const response = await fetch(file);

      if (!response.ok) {
        console.warn("Could not load:", file);
        continue;
      }

      const text = await response.text();

      totalLines += text.split("\n").length;
      totalBytes += new Blob([text]).size;

    } catch (error) {
      console.warn("Error loading:", file);
    }
  }

  const sizeKB = totalBytes / 1024;

  // animate numbers
  animateNumber(
    document.getElementById("lineCount"),
    totalLines,
    2000
  );

  animateNumber(
    document.getElementById("fileSize"),
    sizeKB,
    2000,
    true,
    " KB"
  );
}
</script>
  
</body>
</html>
